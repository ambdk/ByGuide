@page "/Historie"
@model ByGuide.Pages.History.GetAllPostsModel
@{
}

<div id="page-history">
    <h1 class="text-center">Historie</h1>
    <div class="row g-3">
        <div class="col-12">
            <form method="post">
                <div class="input-group mb-3">
                    <input autofocus asp-for="SearchString" class="form-control mr-1" placeholder="Indtast søgeord" />
                    <input type="submit" asp-page-handler="Search" value="Søg" class="btn btn-primary" />
                    <a href="./GetAllPosts" class="btn btn-secondary">Nulstil</a>
                </div>
            </form>

            <form method="post">
                <div class="input-group mb-3">
                    <select asp-for="Category" asp-items="@(new SelectList(Categories.AllowedCategories))" class="form-control" style="max-width: 300px;">
                        <option value="">Vælg en kategori</option>
                    </select>
                    <input type="submit" asp-page-handler="Filter" value="Filter" class="btn btn-primary" />
                    <a href="./GetAllPosts" class="btn btn-secondary">Nulstil</a>
                </div>
            </form>
        </div>
        @if (Model.Posts != null)
        {
            foreach (var post in Model.Posts)
            {
                <div class="col-4">
                    <a class="card content-card text-decoration-none border-0" asp-area="" asp-page="@post.Id">
                        @if (!string.IsNullOrEmpty(post.ImageURL))
                        {
                            <div class="card-header p-0" style="height: 150px; overflow: hidden; width: 100%;">
                                <img src="@post.ImageURL"
                             class="img-fluid" alt="...">
                             </div>
                        }
                        <div class="card-body">
                            <p style="display:none;">@post.Category</p>
                            <h5 style="color: #2F799E;">#@post.Id - @post.Title</h5>
                            <p class="text-truncate" style="color: #81BBD2;">@post.Description</p>
                        </div>
                        <div class="card-footer">
                            <p class="mb-0 text-black"><i class="fa-solid fa-coins"></i> Gratis</p>
                        </div>
                    </a>
                </div>
                <div class="card my-3">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3 class="card-title mb-0">#@post.Id - @post.Title</h3>
                        <div>
                            <a class="btn btn-primary btn-sm" type="button" title="Rediger" asp-page="EditPost" asp-route-id="@post.Id">Rediger</a>
                            <a class="btn btn-danger btn-sm" type="button" title="Slet" asp-page="DeletePost" asp-route-id="@post.Id">Slet</a>
                        </div>
                    </div>
                    <div class="card-body">
                        @if (!string.IsNullOrEmpty(post.ImageURL))
                        {
                            <div style="height: 300px; overflow: hidden; width: 100%;">
                                <img src="@post.ImageURL" class="img-fluid" alt="Billede" style="height: 100%; width: 100%; object-fit: cover; object-position: center;">
                            </div>
                        }
                        <p><h5 class="card-title">Kategori: @post.Category</h5></p>
                        <p class="card-text">@post.Description</p>
                        <p class="card-text"><strong>Adresse:</strong><br />@post.Address</p>
                    </div>
                </div>
            }
        }
    </div>
</div>